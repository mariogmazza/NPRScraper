<!DOCTYPE html>
<html lang="en">

<head>
  <title>The Scraper</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <style>
    /* Remove the navbar's default margin-bottom and rounded borders */

    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }

    /* Add a gray background color and some padding to the footer */

    footer {
      background-color: #f2f2f2;
      padding: 25px;
    }
  </style>
</head>

<body>

  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Mongo Scraper</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav">
          <li class="active">
            <a href="/">Home</a>
          </li>
          <li>
            <a href="/saved">Saved Articles</a>
          </li>
          <li>
            <a href="/scrape">SCRAPE NEW ARTICLES</a>
          </li>
        </ul>
        <!--<ul class="nav navbar-nav navbar-right">
        <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
      </ul>-->
      </div>
    </div>
  </nav>

  <div class="jumbotron">
    <div class="container text-center">
      <h1>MONGO SCRAPER</h1>
      <p>NPR Edition</p>
    </div>
  </div>
  {{{ body }}}




  <div class="modal fade product_view" id="product_view">
    <div class="modal-dialog">
      <div class="modal-content">

      </div>
    </div>
  </div>






  {{!--
  <script src="./public/assets/js/app.js"></script> --}}
</body>
<script type="text/javascript">

  $(document).on("click", ".notes", function () {
    console.log("this is the modal")

  $(".modal-content").empty()
    $(".modal-title").text($(this).data("title"))
     console.log($(this).data("id"))
    $(".addNote").attr("data-id", $(this).data("id"))



    var thisId = $(this).data("id");

    // Now make an ajax call for the Article
    $.ajax({
      method: "GET",
      url: "/articles/" + thisId
    })
      // With that done, add the note information to the page
      .done(function (data) {
        console.log(data);

        // If there's a note in the article
        // if (data.note) {
        // Place the title of the note in the title input
        // $("#titleinput").val(data.note.title);
        // Place the body of the note in the body textarea
        //  $(".myNotes").append("<li>"+ data.note.body +"  <a class='btn btn-danger'>X</a> </li><br>"); 
        // }



     //   <div class="modal fade product_view" id="product_view">
        //  <div class="modal-dialog">
            $(".modal-content").append('<div class="modal-header"><a href="#" data-dismiss="modal" class="class pull-right"><span class="glyphicon glyphicon-remove"></span></a><h3 class="modal-title">'+data.title+'</h3></div><div class="modal-body"><div class="row"><div class="col-md-6 product_content"><ul class="myNotes"></ul><h3> Add Notes </h3><div class="row"> <div class="col-md-4 col-sm-12"><textarea id="bodyinput" rows="4" cols="50"></textarea></div></div><div class="space-ten"></div><div class="btn-ground"><button type="button" class="btn btn-primary addNote" data-dismiss="modal" data-id="'+thisId+'">Confirm</button></div></div></div></div>')
           // </div>
        //  </div>
      //  </div>


           // If there's a note in the article
      if (data.note) {
        console.log(data.note)
      $(".myNotes").append('<li>'+ data.note.body +'  <a class="btn btn-danger">X</a></li><br>')
      }



      });


  })






  // When you click the savenote button
  $(document).on("click", ".addNote", function () {
    // Grab the id associated with the article from the submit button
    var thisId = $(this).attr("data-id");

    // Run a POST request to change the note, using what's entered in the inputs
    $.ajax({
      method: "POST",
      url: "/articles/" + thisId,
      data: {
        title: $(".modal-title").text(),
        // Value taken from note textarea
        body: $("#bodyinput").val()
      }
    })
      // With that done
      .done(function (data) {
        // Log the response
        console.log(data);
      });

    // Also, remove the values entered in the input and textarea for note entry
    $("#bodyinput").val("");
  });


</script>

</html>